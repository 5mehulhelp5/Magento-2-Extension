<?php

// @codingStandardsIgnoreFile

/** @var \Unbxd\ProductFeed\Block\Adminhtml\System\Config\Fieldset\Catalog $block */
?>
<div class="unbxd-system-config-information-container catalog">
    <div class="block notification">
        <?php
        $isSynchronizationAttempt = $block->isSynchronizationAttempt();
        $isComplete = $block->getIsComplete();
        $stateClassName = $isComplete ? 'success' : 'warning';
        $message = __('Product catalog is not synchronized.');
        if ($block->getIsProcessing()) {
            $message = __(\Unbxd\ProductFeed\Model\Feed\Config::FEED_MESSAGE_BY_RESPONSE_TYPE_INDEXING);
        } else if ($isComplete) {
            $message = __(\Unbxd\ProductFeed\Model\Feed\Config::FEED_MESSAGE_BY_RESPONSE_TYPE_COMPLETE);
        }
        ?>
        <div class="messages-container">
            <div class="messages">
                <div class="message message-<?php echo $stateClassName ?>">
                    <?= /* @escapeNotVerified */ $message ?>
                </div>
            </div>
        </div>
    </div>
    <?php if ($isSynchronizationAttempt): ?>
        <div class="block content additional-information"
             data-mage-init='{"collapsible":{
                "animate":{
                    "duration":800,
                    "easing":"easeOutCubic"
                },
                "openedState":"active",
                "active":true
                }}' >
            <p class="title" data-role="title"><?= /* @escapeNotVerified */ __('Last synchronization information:') ?></p>
            <div data-role="content">
                <table>
                    <tbody>
                    <?php if ($type = $block->getLastSynchronizationOperationType()): ?>
                        <tr>
                            <th><?= /* @escapeNotVerified */ __('Synchronization Type') ?></th>
                            <td><?= /* @escapeNotVerified */ __($type) ?></td>
                        </tr>
                    <?php endif; ?>
                    <?php if ($dateTime = $block->getLastCatalogSyncDatetime()): ?>
                        <tr>
                            <th><?= /* @escapeNotVerified */ __('Datetime') ?></th>
                            <td><?= /* @escapeNotVerified */ __($dateTime) ?></td>
                        </tr>
                    <?php endif; ?>
                    <?php if ($status = $block->getLastSynchronizationStatusHtml()): ?>
                        <tr>
                            <th><?= /* @escapeNotVerified */ __('Status') ?></th>
                            <td><?= /* @escapeNotVerified */ __($status) ?></td>
                        </tr>
                    <?php endif; ?>
                    <?php if ($uploadId = $block->getLastUploadId()): ?>
                        <tr>
                            <th><?= /* @escapeNotVerified */ __('Upload ID') ?></th>
                            <td><?= /* @escapeNotVerified */ __($uploadId) ?></td>
                        </tr>
                    <?php endif; ?>
                    <?php if ($uploadedSize = $block->getUploadedSize()): ?>
                        <tr>
                            <th><?= /* @escapeNotVerified */ __('Total Uploaded Size') ?></th>
                            <td><?= /* @escapeNotVerified */ __(
                                    sprintf('%s (children products are not counted)',
                                        $uploadedSize)
                                ) ?>
                            </td>
                        </tr>
                    <?php endif; ?>
                    </tbody>
                </table>
                <a href="<?php echo $this->getUrl('unbxd_productfeed/feed/view')?>">
                    <?= /* @escapeNotVerified */ __('View details') ?>
                </a>
            </div>
        </div>
    <?php endif; ?>
    <div class="block content"
         data-mage-init='{"collapsible":{
            "animate":{
                "duration":800,
                "easing":"easeOutCubic"
            },
            "openedState":"active",
            "active":true
            }}'>
        <p class="title" data-role="title"><?= /* @escapeNotVerified */ __('Manual product catalog synchronization:') ?></p>
        <div data-role="content">
            <ul>
                <li><a href="#unbxd_catalog_actions-head">
                        <?= /* @escapeNotVerified */ __('by actions below (see Manual Synchronization section)') ?></a>
                </li>
                <li><?= /* @escapeNotVerified */ __('by cli commands: %1',
                        '<br/><code>php bin/magento unbxd:product-feed:full</code><br/>
                    <code>php bin/magento unbxd:product-feed:incremental</code>') ?></li>
            </ul>
        </div>
    </div>
</div>